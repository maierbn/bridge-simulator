Scenario 6
==========

======= function solve truss with 8 elements =======
---------- Input parameters ------------
7 node_positions [x, y]:           [[0, 0], [2, 0], [1, 1], [3, 0], [5, 0], [4, 2], [2, 4]]
8 elements [node start, node end]: [[2, 5], [0, 2], [1, 2], [3, 5], [4, 5], [2, 6], [5, 6], [1, 6]]
3 loads [dof, value]:              [[4, -0.5], [12, 1], [13, 0.5]]
8 fixed_dofs:                      [0, 1, 2, 3, 6, 7, 8, 9]
parameter EA = 10

id_matrix:
[[ 4  0  2  6  8  4 10  2]
 [ 5  1  3  7  9  5 11  3]
 [10  4  4 10 10 12 12 12]
 [11  5  5 11 11 13 13 13]]
counting criterion:  8 + 8 - 2 * 7 = 2
 -> hyperstatic (statisch überbestimmt)
Try if subsystem without element 0 is solvable.

======= function solve truss with 7 elements =======
---------- Input parameters ------------
7 node_positions [x, y]:           [[0, 0], [2, 0], [1, 1], [3, 0], [5, 0], [4, 2], [2, 4]]
7 elements [node start, node end]: [[0, 2], [1, 2], [3, 5], [4, 5], [2, 6], [5, 6], [1, 6]]
3 loads [dof, value]:              [[4, -0.5], [12, 1], [13, 0.5]]
8 fixed_dofs:                      [0, 1, 2, 3, 6, 7, 8, 9]
parameter EA = 10

id_matrix:
[[ 0  2  6  8  4 10  2]
 [ 1  3  7  9  5 11  3]
 [ 4  4 10 10 12 12 12]
 [ 5  5 11 11 13 13 13]]
counting criterion:  8 + 7 - 2 * 7 = 1
 -> hyperstatic (statisch überbestimmt)
Try if subsystem without element 0 is solvable.

======= function solve truss with 6 elements =======
---------- Input parameters ------------
7 node_positions [x, y]:           [[0, 0], [2, 0], [1, 1], [3, 0], [5, 0], [4, 2], [2, 4]]
6 elements [node start, node end]: [[1, 2], [3, 5], [4, 5], [2, 6], [5, 6], [1, 6]]
3 loads [dof, value]:              [[4, -0.5], [12, 1], [13, 0.5]]
8 fixed_dofs:                      [0, 1, 2, 3, 6, 7, 8, 9]
parameter EA = 10

id_matrix:
[[ 2  6  8  4 10  2]
 [ 3  7  9  5 11  3]
 [ 4 10 10 12 12 12]
 [ 5 11 11 13 13 13]]
counting criterion:  8 + 6 - 2 * 7 = 0
 -> statically determined (statisch bestimmt)

----- assemble global stiffness matrix from local matrices -----
   - element  0 , angle  135.0 , length  1.41421356237
   - element  1 , angle  63.4349488229 , length  2.2360679775
   - element  2 , angle  116.565051177 , length  2.2360679775
   - element  3 , angle  71.5650511771 , length  3.16227766017
   - element  4 , angle  135.0 , length  2.82842712475
   - element  5 , angle  90.0 , length  4.0

global stiffness matrix k_global:
[[  0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   0.00000000e+00   3.53553391e+00  -3.53553391e+00
   -3.53553391e+00   3.53553391e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
   -9.37349864e-33  -1.53080850e-16]
 [  0.00000000e+00   0.00000000e+00  -3.53553391e+00   6.03553391e+00
    3.53553391e+00  -3.53553391e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
   -1.53080850e-16  -2.50000000e+00]
 [  0.00000000e+00   0.00000000e+00  -3.53553391e+00   3.53553391e+00
    3.85176167e+00  -2.58685061e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
   -3.16227766e-01  -9.48683298e-01]
 [  0.00000000e+00   0.00000000e+00   3.53553391e+00  -3.53553391e+00
   -2.58685061e+00   6.38158380e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
   -9.48683298e-01  -2.84604989e+00]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   8.94427191e-01   1.78885438e+00
    0.00000000e+00   0.00000000e+00  -8.94427191e-01  -1.78885438e+00
    0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   1.78885438e+00   3.57770876e+00
    0.00000000e+00   0.00000000e+00  -1.78885438e+00  -3.57770876e+00
    0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    8.94427191e-01  -1.78885438e+00  -8.94427191e-01   1.78885438e+00
    0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
   -1.78885438e+00   3.57770876e+00   1.78885438e+00  -3.57770876e+00
    0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00  -8.94427191e-01  -1.78885438e+00
   -8.94427191e-01   1.78885438e+00   3.55662133e+00  -1.76776695e+00
   -1.76776695e+00   1.76776695e+00]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00  -1.78885438e+00  -3.57770876e+00
    1.78885438e+00  -3.57770876e+00  -1.76776695e+00   8.92318448e+00
    1.76776695e+00  -1.76776695e+00]
 [  0.00000000e+00   0.00000000e+00  -9.37349864e-33  -1.53080850e-16
   -3.16227766e-01  -9.48683298e-01   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00  -1.76776695e+00   1.76776695e+00
    2.08399472e+00  -8.19083655e-01]
 [  0.00000000e+00   0.00000000e+00  -1.53080850e-16  -2.50000000e+00
   -9.48683298e-01  -2.84604989e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   1.76776695e+00  -1.76776695e+00
   -8.19083655e-01   7.11381685e+00]]

global right hand side load vector f:
[[ 0. ]
 [ 0. ]
 [ 0. ]
 [ 0. ]
 [-0.5]
 [ 0. ]
 [ 0. ]
 [ 0. ]
 [ 0. ]
 [ 0. ]
 [ 0. ]
 [ 0. ]
 [ 1. ]
 [ 0.5]]

----- reduce system by removing fixed dofs -----
k_global_reduced:
[[ 3.85176167 -2.58685061  0.          0.         -0.31622777 -0.9486833 ]
 [-2.58685061  6.3815838   0.          0.         -0.9486833  -2.84604989]
 [ 0.          0.          3.55662133 -1.76776695 -1.76776695  1.76776695]
 [ 0.          0.         -1.76776695  8.92318448  1.76776695 -1.76776695]
 [-0.31622777 -0.9486833  -1.76776695  1.76776695  2.08399472 -0.81908365]
 [-0.9486833  -2.84604989  1.76776695 -1.76776695 -0.81908365  7.11381685]]

f reduced:
[[-0.5]
 [ 0. ]
 [ 0. ]
 [ 0. ]
 [ 1. ]
 [ 0.5]]

----- solve system k*u = f for u -----
number of nonfixed dofs:  6 , rank of stiffness matrix:  6
(these numbers should be equal, otherwise the system is not statically determined)
solution (u reduced):
[[ 0.49822921]
 [ 0.60429522]
 [ 0.48913987]
 [-0.12228497]
 [ 1.50639958]
 [ 0.4       ]]

----- recover full sized u by inserting 0's -----
, u recovered:
[ 0.          0.          0.          0.          0.49822921  0.60429522
  0.          0.          0.          0.          0.48913987 -0.12228497
  1.50639958  0.4       ]

Subsystem without element 0 was solved and is now         considered as O-system. Also compute X-system without that element.

----- setup loads for X-system (force X=1 in x-element) -----
x-element is element 0, between nodes 0 and 2
initial positions of nodes:  [0 0] [1 1]
angle of element: 0.785398163397
subsystem_x_loads = [[0, 0.70710678118654757], [1, 0.70710678118654746], [4, -0.70710678118654757], [5, -0.70710678118654746]]
now solve X-system

======= function solve truss with 6 elements =======
---------- Input parameters ------------
7 node_positions [x, y]:           [[0, 0], [2, 0], [1, 1], [3, 0], [5, 0], [4, 2], [2, 4]]
6 elements [node start, node end]: [[1, 2], [3, 5], [4, 5], [2, 6], [5, 6], [1, 6]]
4 loads [dof, value]:              [[0, 0.70710678118654757], [1, 0.70710678118654746], [4, -0.70710678118654757], [5, -0.70710678118654746]]
8 fixed_dofs:                      [0, 1, 2, 3, 6, 7, 8, 9]
parameter EA = 10

id_matrix:
[[ 2  6  8  4 10  2]
 [ 3  7  9  5 11  3]
 [ 4 10 10 12 12 12]
 [ 5 11 11 13 13 13]]
counting criterion:  8 + 6 - 2 * 7 = 0
 -> statically determined (statisch bestimmt)

----- assemble global stiffness matrix from local matrices -----
   - element  0 , angle  135.0 , length  1.41421356237
   - element  1 , angle  63.4349488229 , length  2.2360679775
   - element  2 , angle  116.565051177 , length  2.2360679775
   - element  3 , angle  71.5650511771 , length  3.16227766017
   - element  4 , angle  135.0 , length  2.82842712475
   - element  5 , angle  90.0 , length  4.0

global stiffness matrix k_global:
[[  0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   0.00000000e+00   3.53553391e+00  -3.53553391e+00
   -3.53553391e+00   3.53553391e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
   -9.37349864e-33  -1.53080850e-16]
 [  0.00000000e+00   0.00000000e+00  -3.53553391e+00   6.03553391e+00
    3.53553391e+00  -3.53553391e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
   -1.53080850e-16  -2.50000000e+00]
 [  0.00000000e+00   0.00000000e+00  -3.53553391e+00   3.53553391e+00
    3.85176167e+00  -2.58685061e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
   -3.16227766e-01  -9.48683298e-01]
 [  0.00000000e+00   0.00000000e+00   3.53553391e+00  -3.53553391e+00
   -2.58685061e+00   6.38158380e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
   -9.48683298e-01  -2.84604989e+00]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   8.94427191e-01   1.78885438e+00
    0.00000000e+00   0.00000000e+00  -8.94427191e-01  -1.78885438e+00
    0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   1.78885438e+00   3.57770876e+00
    0.00000000e+00   0.00000000e+00  -1.78885438e+00  -3.57770876e+00
    0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    8.94427191e-01  -1.78885438e+00  -8.94427191e-01   1.78885438e+00
    0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
   -1.78885438e+00   3.57770876e+00   1.78885438e+00  -3.57770876e+00
    0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00  -8.94427191e-01  -1.78885438e+00
   -8.94427191e-01   1.78885438e+00   3.55662133e+00  -1.76776695e+00
   -1.76776695e+00   1.76776695e+00]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00  -1.78885438e+00  -3.57770876e+00
    1.78885438e+00  -3.57770876e+00  -1.76776695e+00   8.92318448e+00
    1.76776695e+00  -1.76776695e+00]
 [  0.00000000e+00   0.00000000e+00  -9.37349864e-33  -1.53080850e-16
   -3.16227766e-01  -9.48683298e-01   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00  -1.76776695e+00   1.76776695e+00
    2.08399472e+00  -8.19083655e-01]
 [  0.00000000e+00   0.00000000e+00  -1.53080850e-16  -2.50000000e+00
   -9.48683298e-01  -2.84604989e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   1.76776695e+00  -1.76776695e+00
   -8.19083655e-01   7.11381685e+00]]

global right hand side load vector f:
[[ 0.70710678]
 [ 0.70710678]
 [ 0.        ]
 [ 0.        ]
 [-0.70710678]
 [-0.70710678]
 [ 0.        ]
 [ 0.        ]
 [ 0.        ]
 [ 0.        ]
 [ 0.        ]
 [ 0.        ]
 [ 0.        ]
 [ 0.        ]]

----- reduce system by removing fixed dofs -----
k_global_reduced:
[[ 3.85176167 -2.58685061  0.          0.         -0.31622777 -0.9486833 ]
 [-2.58685061  6.3815838   0.          0.         -0.9486833  -2.84604989]
 [ 0.          0.          3.55662133 -1.76776695 -1.76776695  1.76776695]
 [ 0.          0.         -1.76776695  8.92318448  1.76776695 -1.76776695]
 [-0.31622777 -0.9486833  -1.76776695  1.76776695  2.08399472 -0.81908365]
 [-0.9486833  -2.84604989  1.76776695 -1.76776695 -0.81908365  7.11381685]]

f reduced:
[[-0.70710678]
 [-0.70710678]
 [ 0.        ]
 [ 0.        ]
 [ 0.        ]
 [ 0.        ]]

----- solve system k*u = f for u -----
number of nonfixed dofs:  6 , rank of stiffness matrix:  6
(these numbers should be equal, otherwise the system is not statically determined)
solution (u reduced):
[[-1.03195716]
 [-0.93195716]
 [-0.19764235]
 [ 0.04941059]
 [-1.01273837]
 [-0.56568542]]

----- recover full sized u by inserting 0's -----
, u recovered:
[ 0.          0.          0.          0.         -1.03195716 -0.93195716
  0.          0.          0.          0.         -0.19764235  0.04941059
 -1.01273837 -0.56568542]


----- compute X -----
0-system (system with all external loads and element 0 removed):
   displacements:
     node 0, x: 0.0, y: 0.0
     node 2, x: 0.498229206343, y: 0.604295223521
   initial distance between nodes: initial_length = 1.41421356237
   actual distance between nodes: actual_length = 2.19509770146
   extension d0 = actual_length-initial_length = 0.780884139087
X-system (system without external loads and with element 0 cut and member force X=1):
   displacements:
     node 0, x: 0.0, y: 0.0
     node 2, x: -1.03195715769, y: -0.931957157687
   initial distance between nodes: initial_length = 1.41421356237
   actual distance between nodes: actual_length = 0.0751737209234
   additional extension of element 0: extension_x_element = 0.141421356237
   extension d1 = actual_length-initial_length-extension_x_element = -1.48046119769
X = -d0/d1 = 0.52746005117

----- superpose displacements -----
u = subsystem_0_u + X * subsystem_x_u:
[ 0.          0.          0.          0.         -0.04608697  0.11272505
  0.          0.          0.          0.          0.38489142 -0.09622286
  0.97222055  0.10162354]
Created file "scenario_6a_dof8_el6_n7.png".
Subsystem without element 0 was solved and is now         considered as O-system. Also compute X-system without that element.

----- setup loads for X-system (force X=1 in x-element) -----
x-element is element 0, between nodes 2 and 5
initial positions of nodes:  [1 1] [4 2]
angle of element: 0.321750554397
subsystem_x_loads = [[4, 0.94868329805051377], [5, 0.31622776601683794], [10, -0.94868329805051377], [11, -0.31622776601683794]]
now solve X-system

======= function solve truss with 7 elements =======
---------- Input parameters ------------
7 node_positions [x, y]:           [[0, 0], [2, 0], [1, 1], [3, 0], [5, 0], [4, 2], [2, 4]]
7 elements [node start, node end]: [[0, 2], [1, 2], [3, 5], [4, 5], [2, 6], [5, 6], [1, 6]]
4 loads [dof, value]:              [[4, 0.94868329805051377], [5, 0.31622776601683794], [10, -0.94868329805051377], [11, -0.31622776601683794]]
8 fixed_dofs:                      [0, 1, 2, 3, 6, 7, 8, 9]
parameter EA = 10

id_matrix:
[[ 0  2  6  8  4 10  2]
 [ 1  3  7  9  5 11  3]
 [ 4  4 10 10 12 12 12]
 [ 5  5 11 11 13 13 13]]
counting criterion:  8 + 7 - 2 * 7 = 1
 -> hyperstatic (statisch überbestimmt)
Try if subsystem without element 0 is solvable.

======= function solve truss with 6 elements =======
---------- Input parameters ------------
7 node_positions [x, y]:           [[0, 0], [2, 0], [1, 1], [3, 0], [5, 0], [4, 2], [2, 4]]
6 elements [node start, node end]: [[1, 2], [3, 5], [4, 5], [2, 6], [5, 6], [1, 6]]
4 loads [dof, value]:              [[4, 0.94868329805051377], [5, 0.31622776601683794], [10, -0.94868329805051377], [11, -0.31622776601683794]]
8 fixed_dofs:                      [0, 1, 2, 3, 6, 7, 8, 9]
parameter EA = 10

id_matrix:
[[ 2  6  8  4 10  2]
 [ 3  7  9  5 11  3]
 [ 4 10 10 12 12 12]
 [ 5 11 11 13 13 13]]
counting criterion:  8 + 6 - 2 * 7 = 0
 -> statically determined (statisch bestimmt)

----- assemble global stiffness matrix from local matrices -----
   - element  0 , angle  135.0 , length  1.41421356237
   - element  1 , angle  63.4349488229 , length  2.2360679775
   - element  2 , angle  116.565051177 , length  2.2360679775
   - element  3 , angle  71.5650511771 , length  3.16227766017
   - element  4 , angle  135.0 , length  2.82842712475
   - element  5 , angle  90.0 , length  4.0

global stiffness matrix k_global:
[[  0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   0.00000000e+00   3.53553391e+00  -3.53553391e+00
   -3.53553391e+00   3.53553391e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
   -9.37349864e-33  -1.53080850e-16]
 [  0.00000000e+00   0.00000000e+00  -3.53553391e+00   6.03553391e+00
    3.53553391e+00  -3.53553391e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
   -1.53080850e-16  -2.50000000e+00]
 [  0.00000000e+00   0.00000000e+00  -3.53553391e+00   3.53553391e+00
    3.85176167e+00  -2.58685061e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
   -3.16227766e-01  -9.48683298e-01]
 [  0.00000000e+00   0.00000000e+00   3.53553391e+00  -3.53553391e+00
   -2.58685061e+00   6.38158380e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
   -9.48683298e-01  -2.84604989e+00]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   8.94427191e-01   1.78885438e+00
    0.00000000e+00   0.00000000e+00  -8.94427191e-01  -1.78885438e+00
    0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   1.78885438e+00   3.57770876e+00
    0.00000000e+00   0.00000000e+00  -1.78885438e+00  -3.57770876e+00
    0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    8.94427191e-01  -1.78885438e+00  -8.94427191e-01   1.78885438e+00
    0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
   -1.78885438e+00   3.57770876e+00   1.78885438e+00  -3.57770876e+00
    0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00  -8.94427191e-01  -1.78885438e+00
   -8.94427191e-01   1.78885438e+00   3.55662133e+00  -1.76776695e+00
   -1.76776695e+00   1.76776695e+00]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00  -1.78885438e+00  -3.57770876e+00
    1.78885438e+00  -3.57770876e+00  -1.76776695e+00   8.92318448e+00
    1.76776695e+00  -1.76776695e+00]
 [  0.00000000e+00   0.00000000e+00  -9.37349864e-33  -1.53080850e-16
   -3.16227766e-01  -9.48683298e-01   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00  -1.76776695e+00   1.76776695e+00
    2.08399472e+00  -8.19083655e-01]
 [  0.00000000e+00   0.00000000e+00  -1.53080850e-16  -2.50000000e+00
   -9.48683298e-01  -2.84604989e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   1.76776695e+00  -1.76776695e+00
   -8.19083655e-01   7.11381685e+00]]

global right hand side load vector f:
[[ 0.        ]
 [ 0.        ]
 [ 0.        ]
 [ 0.        ]
 [ 0.9486833 ]
 [ 0.31622777]
 [ 0.        ]
 [ 0.        ]
 [ 0.        ]
 [ 0.        ]
 [-0.9486833 ]
 [-0.31622777]
 [ 0.        ]
 [ 0.        ]]

----- reduce system by removing fixed dofs -----
k_global_reduced:
[[ 3.85176167 -2.58685061  0.          0.         -0.31622777 -0.9486833 ]
 [-2.58685061  6.3815838   0.          0.         -0.9486833  -2.84604989]
 [ 0.          0.          3.55662133 -1.76776695 -1.76776695  1.76776695]
 [ 0.          0.         -1.76776695  8.92318448  1.76776695 -1.76776695]
 [-0.31622777 -0.9486833  -1.76776695  1.76776695  2.08399472 -0.81908365]
 [-0.9486833  -2.84604989  1.76776695 -1.76776695 -0.81908365  7.11381685]]

f reduced:
[[ 0.9486833 ]
 [ 0.31622777]
 [-0.9486833 ]
 [-0.31622777]
 [ 0.        ]
 [ 0.        ]]

----- solve system k*u = f for u -----
number of nonfixed dofs:  6 , rank of stiffness matrix:  6
(these numbers should be equal, otherwise the system is not statically determined)
solution (u reduced):
[[ 0.8685586 ]
 [ 0.68967316]
 [-0.35355339]
 [-0.08838835]
 [ 0.41968482]
 [ 0.50596443]]

----- recover full sized u by inserting 0's -----
, u recovered:
[ 0.          0.          0.          0.          0.8685586   0.68967316
  0.          0.          0.          0.         -0.35355339 -0.08838835
  0.41968482  0.50596443]

Subsystem without element 0 was solved and is now         considered as O-system. Also compute X-system without that element.

----- setup loads for X-system (force X=1 in x-element) -----
x-element is element 0, between nodes 0 and 2
initial positions of nodes:  [0 0] [1 1]
angle of element: 0.785398163397
subsystem_x_loads = [[0, 0.70710678118654757], [1, 0.70710678118654746], [4, -0.70710678118654757], [5, -0.70710678118654746]]
now solve X-system

======= function solve truss with 6 elements =======
---------- Input parameters ------------
7 node_positions [x, y]:           [[0, 0], [2, 0], [1, 1], [3, 0], [5, 0], [4, 2], [2, 4]]
6 elements [node start, node end]: [[1, 2], [3, 5], [4, 5], [2, 6], [5, 6], [1, 6]]
4 loads [dof, value]:              [[0, 0.70710678118654757], [1, 0.70710678118654746], [4, -0.70710678118654757], [5, -0.70710678118654746]]
8 fixed_dofs:                      [0, 1, 2, 3, 6, 7, 8, 9]
parameter EA = 10

id_matrix:
[[ 2  6  8  4 10  2]
 [ 3  7  9  5 11  3]
 [ 4 10 10 12 12 12]
 [ 5 11 11 13 13 13]]
counting criterion:  8 + 6 - 2 * 7 = 0
 -> statically determined (statisch bestimmt)

----- assemble global stiffness matrix from local matrices -----
   - element  0 , angle  135.0 , length  1.41421356237
   - element  1 , angle  63.4349488229 , length  2.2360679775
   - element  2 , angle  116.565051177 , length  2.2360679775
   - element  3 , angle  71.5650511771 , length  3.16227766017
   - element  4 , angle  135.0 , length  2.82842712475
   - element  5 , angle  90.0 , length  4.0

global stiffness matrix k_global:
[[  0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   0.00000000e+00   3.53553391e+00  -3.53553391e+00
   -3.53553391e+00   3.53553391e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
   -9.37349864e-33  -1.53080850e-16]
 [  0.00000000e+00   0.00000000e+00  -3.53553391e+00   6.03553391e+00
    3.53553391e+00  -3.53553391e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
   -1.53080850e-16  -2.50000000e+00]
 [  0.00000000e+00   0.00000000e+00  -3.53553391e+00   3.53553391e+00
    3.85176167e+00  -2.58685061e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
   -3.16227766e-01  -9.48683298e-01]
 [  0.00000000e+00   0.00000000e+00   3.53553391e+00  -3.53553391e+00
   -2.58685061e+00   6.38158380e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
   -9.48683298e-01  -2.84604989e+00]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   8.94427191e-01   1.78885438e+00
    0.00000000e+00   0.00000000e+00  -8.94427191e-01  -1.78885438e+00
    0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   1.78885438e+00   3.57770876e+00
    0.00000000e+00   0.00000000e+00  -1.78885438e+00  -3.57770876e+00
    0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    8.94427191e-01  -1.78885438e+00  -8.94427191e-01   1.78885438e+00
    0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
   -1.78885438e+00   3.57770876e+00   1.78885438e+00  -3.57770876e+00
    0.00000000e+00   0.00000000e+00]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00  -8.94427191e-01  -1.78885438e+00
   -8.94427191e-01   1.78885438e+00   3.55662133e+00  -1.76776695e+00
   -1.76776695e+00   1.76776695e+00]
 [  0.00000000e+00   0.00000000e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00  -1.78885438e+00  -3.57770876e+00
    1.78885438e+00  -3.57770876e+00  -1.76776695e+00   8.92318448e+00
    1.76776695e+00  -1.76776695e+00]
 [  0.00000000e+00   0.00000000e+00  -9.37349864e-33  -1.53080850e-16
   -3.16227766e-01  -9.48683298e-01   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00  -1.76776695e+00   1.76776695e+00
    2.08399472e+00  -8.19083655e-01]
 [  0.00000000e+00   0.00000000e+00  -1.53080850e-16  -2.50000000e+00
   -9.48683298e-01  -2.84604989e+00   0.00000000e+00   0.00000000e+00
    0.00000000e+00   0.00000000e+00   1.76776695e+00  -1.76776695e+00
   -8.19083655e-01   7.11381685e+00]]

global right hand side load vector f:
[[ 0.70710678]
 [ 0.70710678]
 [ 0.        ]
 [ 0.        ]
 [-0.70710678]
 [-0.70710678]
 [ 0.        ]
 [ 0.        ]
 [ 0.        ]
 [ 0.        ]
 [ 0.        ]
 [ 0.        ]
 [ 0.        ]
 [ 0.        ]]

----- reduce system by removing fixed dofs -----
k_global_reduced:
[[ 3.85176167 -2.58685061  0.          0.         -0.31622777 -0.9486833 ]
 [-2.58685061  6.3815838   0.          0.         -0.9486833  -2.84604989]
 [ 0.          0.          3.55662133 -1.76776695 -1.76776695  1.76776695]
 [ 0.          0.         -1.76776695  8.92318448  1.76776695 -1.76776695]
 [-0.31622777 -0.9486833  -1.76776695  1.76776695  2.08399472 -0.81908365]
 [-0.9486833  -2.84604989  1.76776695 -1.76776695 -0.81908365  7.11381685]]

f reduced:
[[-0.70710678]
 [-0.70710678]
 [ 0.        ]
 [ 0.        ]
 [ 0.        ]
 [ 0.        ]]

----- solve system k*u = f for u -----
number of nonfixed dofs:  6 , rank of stiffness matrix:  6
(these numbers should be equal, otherwise the system is not statically determined)
solution (u reduced):
[[-1.03195716]
 [-0.93195716]
 [-0.19764235]
 [ 0.04941059]
 [-1.01273837]
 [-0.56568542]]

----- recover full sized u by inserting 0's -----
, u recovered:
[ 0.          0.          0.          0.         -1.03195716 -0.93195716
  0.          0.          0.          0.         -0.19764235  0.04941059
 -1.01273837 -0.56568542]


----- compute X -----
0-system (system with all external loads and element 0 removed):
   displacements:
     node 0, x: 0.0, y: 0.0
     node 2, x: 0.868558603091, y: 0.689673164891
   initial distance between nodes: initial_length = 1.41421356237
   actual distance between nodes: actual_length = 2.51922739294
   extension d0 = actual_length-initial_length = 1.10501383057
X-system (system without external loads and with element 0 cut and member force X=1):
   displacements:
     node 0, x: 0.0, y: 0.0
     node 2, x: -1.03195715769, y: -0.931957157687
   initial distance between nodes: initial_length = 1.41421356237
   actual distance between nodes: actual_length = 0.0751737209234
   additional extension of element 0: extension_x_element = 0.141421356237
   extension d1 = actual_length-initial_length-extension_x_element = -1.48046119769
X = -d0/d1 = 0.746398373894

----- superpose displacements -----
u = subsystem_0_u + X * subsystem_x_u:
[ 0.          0.          0.          0.          0.09830746 -0.00593814
  0.          0.          0.          0.         -0.50107332 -0.05150836
 -0.33622145  0.08373774]
Created file "scenario_6b_dof8_el6_n7.png".

----- compute X -----
0-system (system with all external loads and element 0 removed):
   displacements:
     node 2, x: -0.046086968855, y: 0.11272505344
     node 5, x: 0.38489142405, y: -0.0962228560126
   initial distance between nodes: initial_length = 3.16227766017
   actual distance between nodes: actual_length = 3.5209907899
   extension d0 = actual_length-initial_length = 0.358713129729
X-system (system without external loads and with element 0 cut and member force X=1):
   displacements:
     node 2, x: 0.0983074586653, y: -0.00593814214536
     node 5, x: -0.501073322053, y: -0.0515083647835
   initial distance between nodes: initial_length = 3.16227766017
   actual distance between nodes: actual_length = 2.58339095684
   additional extension of element 0: extension_x_element = 0.316227766017
   extension d1 = actual_length-initial_length-extension_x_element = -0.895114469342
X = -d0/d1 = 0.400745538158

----- superpose displacements -----
u = subsystem_0_u + X * subsystem_x_u:
[ 0.          0.          0.          0.         -0.00669069  0.11034537
  0.          0.          0.          0.          0.18408853 -0.1168646
  0.83748131  0.13518106]
Created file "scenario_6c_dof8_el7_n7.png".
----- plot -----
Created file "scenario_6_dof6_el8_n7.png".
